schema: '2.0'
stages:
  extract_images_from_video:
    cmd: python scripts/image_preprocessing.py extract-images-from-video --path_to_video
      data/raw/video/video.MP4 --path_to_images_folder data/raw/images --amount_of_frames
      150 --metadata data/raw/video/meta.json --colmap_text_folder data/processed/colmap_db/colmap_text
    deps:
    - path: data/raw/video/video.MP4
      md5: 36448c49d0b5d6aa6a342c4e3edef5a5
      size: 257059112
    - path: scripts/image_preprocessing.py
      md5: f125787ea57f8b70945d492b04493427
      size: 7624
    outs:
    - path: data/processed/colmap_db/colmap_text
      md5: 30a10f6608bbe2f8dec112a461286b25.dir
      size: 21418
      nfiles: 2
    - path: data/raw/images
      md5: 3847d76dd3ca49ebcf2353952ef207f2.dir
      size: 229486879
      nfiles: 153
  crop_and_resize_images:
    cmd: python scripts/image_preprocessing.py crop-resize-images --path_to_images_folder
      data/raw/images --path_to_cropped_images_folder data/interim/
    deps:
    - path: data/raw/images
      md5: 3847d76dd3ca49ebcf2353952ef207f2.dir
      size: 229486879
      nfiles: 153
    - path: scripts/image_preprocessing.py
      md5: f125787ea57f8b70945d492b04493427
      size: 7624
    outs:
    - path: data/interim
      md5: 60dd1509407db267dca7da9ec17a7cb5.dir
      size: 158264112
      nfiles: 153
  remove_background:
    cmd: python scripts/image_preprocessing.py remove-background --path_to_cropped_images_folder
      data/interim/ --images_no_background data/processed/images --model_type new
    deps:
    - path: data/interim/
      md5: 60dd1509407db267dca7da9ec17a7cb5.dir
      size: 158264112
      nfiles: 153
    - path: scripts/image_preprocessing.py
      md5: b97a09d56f8fbf0c53aefc5736067d51
      size: 7706
    outs:
    - path: data/processed/images/
      md5: 9199d79efb4c39b8691ce93c67dcb358.dir
      size: 66560977
      nfiles: 153
  colmap:
    cmd: python scripts/run_colmap.py --images data/processed/images --colmap_db data/processed/colmap_db/colmap.db
      --text data/processed/colmap_db/colmap_text  --colmap_matcher exhaustive
    deps:
    - path: data/processed/images
      md5: 8c0e97a145b768f494cfca3f46dcbd67.dir
      size: 177160908
      nfiles: 152
    outs:
    - path: data/processed/colmap_db/
      md5: 8f22312c21f4d3ce6500eda5d3cb26d0.dir
      size: 95994849
      nfiles: 12
  colmap2nerf:
    cmd: python scripts/colmap2nerf.py --image_folder data/processed/images --colmap_text_folder
      data/processed/colmap_db/colmap_text --output data/processed/configs/nerf_transforms.json
    deps:
    - path: data/processed/colmap_db/
      md5: 8f22312c21f4d3ce6500eda5d3cb26d0.dir
      size: 95994849
      nfiles: 12
    outs:
    - path: data/processed/configs/nerf_transforms.json
      md5: 17f9c109834b75940e734f2c118d1c24
      size: 8638
