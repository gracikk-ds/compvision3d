schema: '2.0'
stages:
  extract_calibration_images:
    cmd: python scripts/camera_calibration.py extract-calibration-images --video_dir
      data/raw/calibration/video/calibration.mov --path_to_images_folder data/raw/calibration/images
      --amount_of_frames 45
    deps:
    - path: data/raw/calibration/video
      md5: 406fffc8188212a3765b670a51cce842.dir
      size: 115520103
      nfiles: 1
    - path: scripts/camera_calibration.py
      md5: 3dd4aafdff0ad4b342e05ee9e9388748
      size: 5862
    outs:
    - path: data/raw/calibration/images
      md5: 94923d78f2ae625c4b400594acb68734.dir
      size: 9800045
      nfiles: 46
  camera_calibration:
    cmd: python scripts/camera_calibration.py calibrate --image_dir data/raw/calibration/images
      --image_format jpg --output_path data/processed/colmap_db/colmap_text/ --square_size
      2
    deps:
    - path: data/raw/calibration/images
      md5: 94923d78f2ae625c4b400594acb68734.dir
      size: 9800045
      nfiles: 46
    - path: scripts/camera_calibration.py
      md5: 3dd4aafdff0ad4b342e05ee9e9388748
      size: 5862
    outs:
    - path: data/processed/colmap_db/colmap_text/cameras.txt
      md5: 8df09b73fdff02bdae2c5ae45a1f8e99
      size: 288
  extract_images_from_video:
    cmd: python scripts/image_preprocessing.py extract-images-from-video --path_to_video
      data/raw/video/video.mov --path_to_images_folder data/raw/images --amount_of_frames
      150 --metadata data/raw/meta/meta.json --colmap_text_folder data/processed/colmap_db/colmap_text
    deps:
    - path: data/processed/colmap_db/colmap_text/cameras.txt
      md5: 8df09b73fdff02bdae2c5ae45a1f8e99
      size: 288
    - path: data/raw/meta/meta.json
      md5: 52cbe9a5e9b0acaf58ff30f27d4eee23
      size: 142
    - path: data/raw/meta/theta.json
      md5: ea67294e044d9f691f70dff39bc1e900
      size: 48870
    - path: data/raw/video
      md5: d3392aa4268fd8529a80fda3d79ea610.dir
      size: 599990547
      nfiles: 1
    - path: scripts/image_preprocessing.py
      md5: 4355a094f97bfe2a922f74707d14c4cf
      size: 8418
    outs:
    - path: data/processed/colmap_db/colmap_text/images.txt
      md5: 7be37e3fcd3bd92b0953c78f96b6cef9
      size: 24119
    - path: data/raw/images
      md5: f19d3ad7363e6fc0622e5ae29d12dfb4.dir
      size: 65820004
      nfiles: 153
  crop_and_resize_images:
    cmd: python scripts/image_preprocessing.py crop-resize-images --path_to_images_folder
      data/raw/images --path_to_cropped_images_folder data/interim/
    deps:
    - path: data/raw/images
      md5: f19d3ad7363e6fc0622e5ae29d12dfb4.dir
      size: 65820004
      nfiles: 153
    - path: scripts/image_preprocessing.py
      md5: 4355a094f97bfe2a922f74707d14c4cf
      size: 8418
    outs:
    - path: data/interim
      md5: 415e6098dd983fe215090cac659cd9d2.dir
      size: 131194275
      nfiles: 153
  remove_background:
    cmd: python scripts/image_preprocessing.py remove-background --path_to_cropped_images_folder
      data/interim/ --images_no_background data/processed/images --model_type new
    deps:
    - path: data/interim/
      md5: 415e6098dd983fe215090cac659cd9d2.dir
      size: 131194275
      nfiles: 153
    - path: scripts/image_preprocessing.py
      md5: 4355a094f97bfe2a922f74707d14c4cf
      size: 8418
    outs:
    - path: data/processed/images/
      md5: 7f9bc272fda718c71c830f536e930e30.dir
      size: 55893579
      nfiles: 153
  colmap2nerf:
    cmd: python scripts/colmap2nerf.py --image_folder data/processed/images --colmap_text_folder
      data/processed/colmap_db/colmap_text --output data/processed/configs/nerf_transforms.json
    deps:
    - path: data/processed/colmap_db/
      md5: 3361fe12bd0b2037de500c5441928366.dir
      size: 97176
      nfiles: 6
    - path: data/processed/images/
      md5: 14cbbb76933326680adc1623667818f5.dir
      size: 58915308
      nfiles: 161
    - path: scripts/colmap2nerf.py
      md5: c12a3161e99daffd3dd70b76036644f9
      size: 8034
    outs:
    - path: data/processed/configs/nerf_transforms.json
      md5: 7c0c4c226fafabf603659e08e8173398
      size: 95862
