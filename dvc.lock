schema: '2.0'
stages:
  extract_calibration_images:
    cmd: python scripts/camera_calibration.py extract-calibration-images --video_dir
      data/raw/calibration/video/calibration.MOV --path_to_images_folder data/raw/calibration/images
      --amount_of_frames 30
    deps:
    - path: data/raw/calibration/video
      md5: d0982925721723fc238cb9294917d812.dir
      size: 63767820
      nfiles: 1
    - path: scripts/camera_calibration.py
      md5: d8bb20c28fb9c151fc08f9b230d4d4a5
      size: 5866
    outs:
    - path: data/raw/calibration/images
      md5: 50239b461b3e9ced5c1eb3dd262f94bc.dir
      size: 43004440
      nfiles: 32
  camera_calibration:
    cmd: python scripts/camera_calibration.py calibrate --image_dir data/raw/calibration/images
      --image_format jpg --output_path data/processed/colmap_db/colmap_text/ --square_size
      2.5
    deps:
    - path: data/raw/calibration/images
      md5: ca2f55e1c23101ec340ad1e888618921.dir
      size: 45435228
      nfiles: 29
    - path: scripts/camera_calibration.py
      md5: 5b4201f1b2545bf64fac731e684aabe6
      size: 5864
    outs:
    - path: data/processed/colmap_db/colmap_text/cameras.txt
      md5: e12e188ed43e3bfb1c7022d01a99e717
      size: 294
  extract_images_from_video:
    cmd: python scripts/image_preprocessing.py extract-images-from-video --path_to_video
      data/raw/video/video.mp4 --path_to_images_folder data/raw/images --amount_of_frames
      100 --metadata data/raw/meta/meta.json --colmap_text_folder data/processed/colmap_db/colmap_text
      --theta_path data/raw/meta/theta.json
    deps:
    - path: data/processed/colmap_db/colmap_text/cameras.txt
      md5: e12e188ed43e3bfb1c7022d01a99e717
      size: 294
    - path: data/raw/meta/meta.json
      md5: ce72ecc5f10aace9f581ec1f0a468550
      size: 314
    - path: data/raw/meta/theta.json
      md5: ea67294e044d9f691f70dff39bc1e900
      size: 48870
    - path: data/raw/video
      md5: b382c91d4d46b09ddb89f59608cf0272.dir
      size: 202316079
      nfiles: 2
    - path: scripts/image_preprocessing.py
      md5: ed51915c7a31d01f8f70c2c2ba45a35e
      size: 8476
    outs:
    - path: data/processed/colmap_db/colmap_text/images.txt
      md5: 2889a588dbc8cd458b26b5d8a8ffb12f
      size: 15416
    - path: data/raw/images
      md5: 4c42b7eea41b4fc5bf6a4f0064f3e2ce.dir
      size: 19401534
      nfiles: 101
  crop_and_resize_images:
    cmd: python scripts/image_preprocessing.py crop-resize-images --path_to_images_folder
      data/raw/images --path_to_cropped_images_folder data/interim/
    deps:
    - path: data/raw/images
      md5: 4c42b7eea41b4fc5bf6a4f0064f3e2ce.dir
      size: 19401534
      nfiles: 101
    - path: scripts/image_preprocessing.py
      md5: ed51915c7a31d01f8f70c2c2ba45a35e
      size: 8476
    outs:
    - path: data/interim
      md5: fb1be23e7b3eb444c843dc240276c74a.dir
      size: 48256991
      nfiles: 101
  remove_background:
    cmd: python scripts/image_preprocessing.py remove-background --path_to_cropped_images_folder
      data/interim/ --images_no_background data/processed/images --model_type new
    deps:
    - path: data/interim/
      md5: fb1be23e7b3eb444c843dc240276c74a.dir
      size: 48256991
      nfiles: 101
    - path: scripts/image_preprocessing.py
      md5: ed51915c7a31d01f8f70c2c2ba45a35e
      size: 8476
    outs:
    - path: data/processed/images/
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
  colmap2nerf:
    cmd: python scripts/colmap2nerf.py --image_folder data/processed/images --colmap_text_folder
      data/processed/colmap_db/colmap_text --output data/processed/configs/nerf_transforms.json
    deps:
    - path: data/processed/colmap_db/
      md5: e66e9e0c91b219209acd4129db15ff3c.dir
      size: 16602
      nfiles: 3
    - path: data/processed/images/
      md5: 7fbb46a2b0640b4e8a8b52475bc8bcc6.dir
      size: 38424466
      nfiles: 102
    - path: scripts/colmap2nerf.py
      md5: c12a3161e99daffd3dd70b76036644f9
      size: 8034
    outs:
    - path: data/processed/configs/nerf_transforms.json
      md5: 718c72ec937cdb140c4b2568a66fbb4c
      size: 63565
