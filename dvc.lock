schema: '2.0'
stages:
  extract_calibration_images:
    cmd: python scripts/camera_calibration.py extract-calibration-images --video_dir
      data/raw/calibration/video/calibration.MOV --path_to_images_folder data/raw/calibration/images
      --amount_of_frames 30
    deps:
    - path: data/raw/calibration/video
      md5: d0982925721723fc238cb9294917d812.dir
      size: 63767820
      nfiles: 1
    - path: scripts/camera_calibration.py
      md5: d8bb20c28fb9c151fc08f9b230d4d4a5
      size: 5866
    outs:
    - path: data/raw/calibration/images
      md5: 50239b461b3e9ced5c1eb3dd262f94bc.dir
      size: 43004440
      nfiles: 32
  camera_calibration:
    cmd: python scripts/camera_calibration.py calibrate --image_dir data/raw/calibration/images
      --image_format jpg --output_path data/processed/colmap_db/colmap_text/ --square_size
      2.5
    deps:
    - path: data/raw/calibration/images
      md5: 7f1b9765f3f83390751516636d2678bf.dir
      size: 28574554
      nfiles: 21
    - path: scripts/camera_calibration.py
      md5: bcfb2b2f238e536c599c7e55c304d09a
      size: 6065
    outs:
    - path: data/processed/colmap_db/colmap_text/cameras.txt
      md5: c4458b6c42ece305fa8490511afd9088
      size: 296
  extract_images_from_video:
    cmd: python scripts/image_preprocessing.py extract-images-from-video --path_to_video
      data/raw/video/video.MP4 --path_to_images_folder data/raw/images --amount_of_frames
      150 --metadata data/raw/meta/meta.json --colmap_text_folder data/processed/colmap_db/colmap_text
    deps:
    - path: data/processed/colmap_db/colmap_text/cameras.txt
      md5: c4458b6c42ece305fa8490511afd9088
      size: 296
    - path: data/raw/video
      md5: ffc745db5bf0975c68427ba29c300365.dir
      size: 389656936
      nfiles: 2
    - path: scripts/image_preprocessing.py
      md5: 554a754c5ff504f9db72b7f04840582c
      size: 8603
    outs:
    - path: data/processed/colmap_db/colmap_text/images.txt
      md5: 415fb65d427a17de2cb96cf31e49eae2
      size: 24900
    - path: data/raw/images
      md5: df80c9d0127a10b0a81b746dd556f0cd.dir
      size: 231166426
      nfiles: 154
  crop_and_resize_images:
    cmd: python scripts/image_preprocessing.py crop-resize-images --path_to_images_folder
      data/raw/images --path_to_cropped_images_folder data/interim/
    deps:
    - path: data/raw/images
      md5: df80c9d0127a10b0a81b746dd556f0cd.dir
      size: 231166426
      nfiles: 154
    - path: scripts/image_preprocessing.py
      md5: 554a754c5ff504f9db72b7f04840582c
      size: 8603
    outs:
    - path: data/interim
      md5: 495690ed4d3a9b80f475e319f2da620c.dir
      size: 151951202
      nfiles: 154
  remove_background:
    cmd: python scripts/image_preprocessing.py remove-background --path_to_cropped_images_folder
      data/interim/ --images_no_background data/processed/images --model_type new
    deps:
    - path: data/interim/
      md5: 495690ed4d3a9b80f475e319f2da620c.dir
      size: 151951202
      nfiles: 154
    - path: scripts/image_preprocessing.py
      md5: 554a754c5ff504f9db72b7f04840582c
      size: 8603
    outs:
    - path: data/processed/images/
      md5: 3e6690a7ee4df664595f15e62c9bee8b.dir
      size: 51319124
      nfiles: 154
  colmap2nerf:
    cmd: python scripts/colmap2nerf.py --image_folder data/processed/images --colmap_text_folder
      data/processed/colmap_db/colmap_text --output data/processed/configs/nerf_transforms.json
    deps:
    - path: data/processed/colmap_db/
      md5: 271be99bd3eb528a1616a3c0b9fbb12a.dir
      size: 25223
      nfiles: 3
    - path: data/processed/images/
      md5: 3e6690a7ee4df664595f15e62c9bee8b.dir
      size: 51319124
      nfiles: 154
    - path: scripts/colmap2nerf.py
      md5: c12a3161e99daffd3dd70b76036644f9
      size: 8295
    outs:
    - path: data/processed/configs/nerf_transforms.json
      md5: 640ac442bc333f0ba6ac6128332aeae3
      size: 101369
